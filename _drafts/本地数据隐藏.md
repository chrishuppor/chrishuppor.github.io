本地数据隐藏。

# 普通隐藏文件

将文件属性设置为隐藏。

```
SetFileAttributesW(szLogFile, FILE_ATTRIBUTE_HIDDEN)//显示隐藏文件就可以看到
```

显示：显示隐藏文件

缺点：有很多用户会设置“显示隐藏文件”选项，很容易被发现。

# 系统隐藏文件

将文件属性设置为系统隐藏。

```
SetFileAttributesW(szLogFile, FILE_ATTRIBUTE_SYSTEM | FILE_ATTRIBUTE_ HIDDEN)
```

显示：去掉勾选“隐藏受保护的文件”

![图1](Snipaste_2019-08-01_11-23-06.PNG)

优势：一般用户不会选择显示系统隐藏的文件

缺点：较容易被发现

# 备份数据流

备份数据流是NTFS系统所特有的机制。在NTFS文件系统下，每个文件都可以存在多个数据流。通俗的理解，就是其它文件（单纯的数据也可以）可以“寄宿”在某个文件身上，而在资源管理器中却只能看到宿主文件，找不到寄宿文件。

创建：

* cmd命令创建

* windows API创建

  ```c
  #include <windows.h>
  #include <stdio.h>
  
  void main( )
  {
      HANDLE hFile, hStream;
      DWORD dwRet;
  
      hFile = CreateFile( "testfile",
                         GENERIC_WRITE,
                         FILE_SHARE_WRITE,
                         NULL,
                         OPEN_ALWAYS,
                         0,
                         NULL );
      if( hFile == INVALID_HANDLE_VALUE )
          printf( "Cannot open testfile\n" );
      else
          WriteFile( hFile, "This is testfile", 16, &dwRet, NULL );
  
      hStream = CreateFile( "testfile:stream",//stream就是ADS流的名称
                           GENERIC_WRITE,
                           FILE_SHARE_WRITE,
                           NULL,
                           OPEN_ALWAYS,
                           0,
                           NULL );
      if( hStream == INVALID_HANDLE_VALUE )
          printf( "Cannot open testfile:stream\n" );
      else
          WriteFile(hStream, "This is testfile:stream", 23, &dwRet, NULL);
  }
  ```


cmd输入`echo 111>1.txt|2.txt`,则'111'会输出到2.txt中，但文件系统只显示1.txt，而2.txt文件寄生于1.txt文件。要想删除2.txt只能通过删除1.txt来完成。



## 参考文章

* [WINDOWS 备用数据流（ADS）的妙用___转载](https://www.cnblogs.com/feiyucha/p/9940895.html)

