---
layout: post
title: "2019SCTF_BabyRe复现学习"
date: 2019-7-12 22:42:46
categories: Reverse
tags: WriteUp
---

2019年SCTF的BabyRe，一道一拖三的主要考算法的题，劝退算法菜鸟。*于是这个题成了我的IDA的使用实践样例。*


# 题目流程

本题一共有三段flag，这三个flag之间没有联系。

1. 首先走一个三维迷宫，flag就是其的最短路线。
2. 然后base64解密一个字符串，解密结果与sctf_9102相同，flag就是这个字符串。
3. 最后用基于SM4魔改的算法加密一个字符串，要与已知的加密结果匹配，flag就是这个字符串。

# 复现流程（挖坑）

1. 将程序拖入IDA，通过string可以直接定位到main函数。

2. 按F5，提示指针不在函数内，需要选中main函数的汇编代码，按P键创建函数，创建成功后就可以反编译了。

3. 反编译代码会出现奇怪的JUMPOUT，并且几乎每个函数都有。

   ![图1 奇怪的JUMPOUT](https://chrishuppor.github.io/image/Snipaste_2019-06-29_22-54-46.PNG)

   右键菜单选择“Copy to assembly”查看其对应的汇编代码。如图，发现是应该jnb到loc_ADC+1，但IDA将loc_ADC+1的机器码识别为loc_ADC的机器码所在汇编指令的一部分，所以就出现了奇怪的JUMPOUT。

   而实际上loc_ADC的机器码根本无用，所以直接改为nop，然后反编译就没有问题了。

4. ......算法的问题先放放......

# 感想

要想逆向强，算法不能差！不知道要补多久......